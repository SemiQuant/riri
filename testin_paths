Script_dir="/wynton/home/ernst/jdlim/riboseq/riri"



threads="1"
ref="${Script_dir}/references/NC_000962.fasta"
gtf="${Script_dir}/references/NC_000962.gff"

read_dir="/wynton/home/ernst/jdlim/riboseq/fastq"
reads="$2"
out_dir="/wynton/home/ernst/jdlim/riboseq"
nme="test_riboseq"
strand="yes"
container="$2"
get_metrics="$2"

fastQC="Y"
max_missmatch="2"
min_len="24"
max_len="36"
trim_fasta="${Script_dir}/references/adapts.fasta"


############################
Script_dir="/wynton/home/ernst/jdlim/riboseq/riri"
threads="1"
ref="${Script_dir}/references/NC_000962.fasta"
gt="${Script_dir}/references/NC_000962.gff"
name="test_rnaseq"
out_dir="/wynton/home/ernst/jdlim/riboseq"
adapters="${Script_dir}/references/adapts.fasta"
strand="yes"
rRNA="Y"
read1="/wynton/home/ernst/jdlim/riboseq/riri/rnaseq_test/NC_1_R1.fq.gz"
read2="/wynton/home/ernst/jdlim/riboseq/riri/rnaseq_test/NC_1_R2.fq.gz"
trim="Y"
fastQC="Y"

/wynton/home/ernst/jdlim/riboseq/riri_v0.1.sif




cd "/wynton/home/ernst/jdlim/riboseq/"
git clone --recursive https://github.com/SemiQuant/riri.git
singularity pull library://semiquant/default/riri:v0.1

singularity shell /wynton/home/ernst/jdlim/riboseq/riri_v0.1.sif 


samtools tview --reference ../riri/references/NC_000962.fasta -p NC_000962.3:2402030 riboSeq_R1.bam















singularity shell /wynton/home/ernst/jdlim/riboseq/riri_v0.1.sif 

cd "/wynton/home/ernst/jdlim/riboseq/riboSeq_R1_riri"
ref_rem="/wynton/home/ernst/jdlim/riboseq/riri/references/NC_000962_rRNAs.fasta"
threads=1
max_missmatch=2
reads="riboSeq_R1.fq.gz"

  bowtie --threads $threads --seed 1987 -x "$ref_rem" -q "$reads" -a -v $max_missmatch \
    --un "${reads}_cleaned.fq" > /dev/null 




ref="/wynton/home/ernst/jdlim/riboseq/riri/references/NC_000962.fasta"
threads=1
gtf="/wynton/home/ernst/jdlim/riboseq/riri/references/NC_000962.gtf"

bedtools maskfasta -fi "$ref" -bed "${gtf/.g*/_rRNA.gtf}" -fo "${ref/.f*/_rRNAsMasked.fasta}"
bowtie-build --threads $threads "${ref/.f*/_rRNAsMasked.fasta}" "${ref/.f*/_rRNAsMasked.fasta}"



